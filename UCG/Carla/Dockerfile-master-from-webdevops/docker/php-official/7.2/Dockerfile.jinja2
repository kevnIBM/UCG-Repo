{{ baselayout.dockerStage() }}

{{ docker.fromOfficial("php", "7.2-fpm") }}

{{ docker.version() }}

{{ environment.general() }}
{{ environment.base() }}
{{ environment.baseApp() }}

{{ baselayout.copy() }}

{{ docker.copy('conf/', '/opt/docker/') }}

RUN set -x \
    {{ bootstrap.debian('stretch') }}

RUN set -x \
    {{ base.debian() }} \
    {{ provision.runBootstrap() }} \
    {{ docker.cleanup() }}

RUN set -x \
    {{ baseapp.debian() }} \
    {{ provision.runBootstrap() }} \
    {{ docker.cleanup() }}

RUN set -x \
    {{ php.official(version='7.2',debian='stretch') }} \
    {{ provision.runBootstrap() }} \
    {{ docker.cleanup() }}

{{ docker.workdir('/') }}
{{ docker.expose('9000') }}
{{ docker.entrypoint("/entrypoint") }}
{{ docker.cmd("supervisord") }}
